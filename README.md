# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build
```

## Описание проекта:

Проект представляет собой интернет-магазин для веб-разработчиков под названием "Веб-ларек". Это место, где пользователи
могут:

Просматривать широкий ассортимент товаров, предназначенных для веб-разработки.

Добавлять товары в корзину для удобства дальнейшей покупки.

Оформлять заказы и совершать покупки через удобный интерфейс.

## Архитектура проекта (MVC):

Архитектура MVC помогает разделить ответственность между слоями и делает код более поддерживаемым и тестируемым.

## Описание базовых классов:

Класс Api имеет следующие свойства и методы.

Методы:

- `handleResponse(response: Response): Promise<T>` - обработчик ответа сервера.

- `get(uri: string)` - принимает изменяющеюся часть url-адреса, возвращает ответ от сервера.

- `post(uri: string, data: object, method: ApiPostMethods = 'POST')` - принимает изменяющеюся часть url-адреса,
  принимает данные в виде объекта для отправки на сервер, type ApiPostMethods = 'POST' | 'PUT' | 'DELETE'.

Класс **EventEmitter** реализует паттерн «Observer/Наблюдатель» и обеспечивает работу событий, его методы позволяют
устанавливать и снимать слушатели событий, вызвать слушатели при возникновении события.

Методы:

- `on` - для подписки на событие.
- `off` - для отписки от события.
- `emit` - уведомления подписчиков о наступлении события соответственно.
- `onAll` - для подписки на все события.
- `offAll` - сброса всех подписчиков.
- `trigger` - генерирует заданное событие с заданными аргументами. Это позволяет передавать его в качестве обработчика
  события в другие классы. Эти классы будут генерировать события, не будучи при этом напрямую зависимыми от класса
  EventEmitter.

## Описание данных (Интерфейсы):

**Интерфейс данных корзины IBasketData**. 
Данные, которые посылаются вместе с событием basketEvents.CHANGED.

***Поля***:
- `products`: Product[]; - список товаров в корзине
- `total`: number; - общая сумма товаров
## -------------------

**Интерфейс данных заказа. 1 шаг. IOrderChange**.
Данные, которые посылаются вместе с событием CheckoutEvent.ORDER_CHANGED.

***Поля***:
- `payment?`: Payment; - Выбранный способ оплаты. Может отсутствовать, если пользователь его ещё не указал.
- `address`: string; - адрес доставки
- `valid`: boolean; - Флаг, указывающий на валидность введённых данных (оплаты и адреса).
- `error`: string; - Текст ошибки, если данные невалидны. Пустая строка, если ошибок нет.


## -------------------

## Модели данных:

Класс **Catalog**

Наследуется от абстрактной модели данных AModel. Сообщает всем подписчикам, что товары пришли с сервера и наш каталог товаров изменился.

***Поля***:
Не имеет.


***Конструктор***: 
Наследует от абстрактной модели данных AModel.


***Методы***:  

- `setProducts` - оповещает всех подписчиков об изменении каталога товаров;
Принимает параметром массив товаров, которые пришли с сервера.

## -------------------

Класс **Basket**

Модель данных корзины интернет-магазина.
Реализует хранение товаров и управление товарами в корзине.
Наследуется от абстрактной модели данных AModel.
Имеет событийную модель для уведомления подписчиков об изменениях.


***Поля***:
- `products` хранит массив товаров типа Product[].
- 
***Конструктор***:
  Наследует конструктор от абстрактной модели данных AModel.

***Методы***:
- `getProducts` - Возвращает массив объектов товаров типа Product[]. 
- `getTotal` - Возвращает сумму цен товаров в корзине типа number.
- `add` - Метод принимает параметр product типа Product. Добавляет товар в корзину, конкретно в наш массив, в поле products
и сообщает об изменениях подписчикам.
- `remove` - Метод принимает параметр product типа Product. Удаляет товар из корзины, конкретно из нашего массива, в поле products
    и сообщает об изменениях подписчикам.
- `clear` - Удаляет все товары из корзины, очищает наш массив в поле products.
  и сообщает об изменениях подписчикам.
- `changed` - Внутренний метод, вызываемый после каждого изменения. Генерирует событие CHANGED с актуальными данными корзины.
## -------------------

Класс **Order**
Модель данных заказа товаров. 1 шаг.

Реализует хранение данных о выбранном способе оплаты и адресе.
Наследуется от абстрактной модели данных AModel.

***Поля***:
- `_payment` хранит способ оплаты выбранный пользователем типа Payment = 'card' | 'cash';.
- `_address` хранит адрес пользователя типа string, изначально пустая строка.

***Конструктор***:
Наследует конструктор от абстрактной модели данных AModel.

***Методы***:
- `getPayment` - Возвращает способ оплаты, выбранный пользователем типа Payment. Может не иметь значения.
- `getAddress` - Возвращает адрес, введенный пользователем типа string.
- `setPayment` - Принимаем параметром способ оплаты, типа Payment. Добавляет его в поле _payment. Сообщает подписчикам об изменениях.
- `getValid` - Возвращает true или false типа boolean, если пользователь выбрал способ оплаты и ввел адрес.
- `setAddress` - Принимает адрес типа string, введенный пользователем. Добавляет его в поле _address. Сообщает подписчикам об изменениях.
- `getError` - Возвращает первую подходящую ошибку типа string если не выбран способ оплаты и не заполнено поле с адресом.
- `orderChanged` - Внутренний метод, вызываемый после каждого изменения. Генерирует событие ORDER_CHANGED с актуальными данными заказа.

## -------------------


Позволяют хранить и обрабатывать данные с сервера и от пользователей

Класс **LarekApi** наследуется от класса **Api**, передаёт и получает данные от сервера.

Методы:

- `getProductList` - получаем массив товаров с сервера.
- `getProduct` - получаем товар с сервера.
- `placeOrder` - создаём заказ в Api.

Класс **CartModel** хранит и работает с данными полученными от пользователя.

Методы:

- `getCount` - возвращает количество товаров в корзине.
- `getTotal` - считает и возвращает общую сумму всех товаров в корзине.
- `addProduct` - добавляет товар в корзину.
- `deleteProduct` - удаляет товар из корзины.
- `getProducts` - возвращает добавленные в корзину товары
- `clear` - очищает корзину

Класс **ProductsModel** принимает и хранит данные всех продуктов полученных с сервера.

Методы:

- set `products` - записываем данные товаров
- get `products` - получаем данные товаров

Класс **CheckoutModel** хранит данные полученные от пользователя в процессе оформления заказа.

Методы:

- `setOrderAddress` - сохраняет адрес и способ оплаты пользователя.
- `validateOrderAddress` - проверяет адрес и способ оплаты пользователя.
- `setOrderContacts` - сохраняет контакты пользователя.
- `validateOrderContacts` - проверяет контакты пользователя.
- `getOrderData` - возвращает данные заказа.



## Отображения

Позволяют отображать элементы страницы с полученными данными, позволяют взаимодействовать с пользователем.

Класс **Modal** управляет модальными окнами.
Методы:
- `open` - отображает модальное окно.
- `close` - закрывает модальное окно.

Класс **Success** для отображения успешного заказа.
Методы:
- `setTotal` - передаёт количество списанных синапсов.

Класс **MiniCart** отвечает за миниатюрную корзину в хедере.
- `setCount` - устанавливает какое количество товаров находится в корзине.

Класс **Cart** для отображения корзины.
Методы:
- `setProduct` - передаёт список товаров в корзину

Класс **CartItem** для отображения карточки товара в корзине.
Методы:
- `setProduct` - передаёт товар
- `setIndex` - передаёт порядковый номер товара

Класс **ProductCard** для отображения карточки товара на веб странице.
Методы:
- `setProduct` - передаёт товар
- `setCategory` - передаёт категорию товара

Класс **ProductCardPreview** для отображения модального окна товара
Методы:
- `setProduct` - передаёт товар
- `setCategory` - передаёт категорию товара

Класс **CheckoutPaymentAddress** для отображения метода оплаты и адреса, принимает соответствующие данные от пользователя.

Класс **CheckoutContacts** для отображения email и телефона, принимает соответствующие данные от пользователя.

## События

###  Инициализация
- `products:ready` - данные товаров загружены и готовы отправиться в отображения

### Модальные окна
- `modal:productPreview` - открытие модального окна товара
- `modal:basket` - открытие модального окна корзины
- `modal:checkout:paymentAddress` - открытие модального окна оформления заказа с выбором оплаты и полем адреса
- `modal:checkout:contacts` - открытие модального окна оформления заказа с полями email и телефона
- `modal:checkout:success` - открытие модального окна успешного заказа
- `modal:close` - закрытие модального окна

### Корзина
- `basket:add` - добавление товара в корзину
- `basket:remove` - удаление товара из корзины
- `basket:clear` - очистка корзины
- `basket:changed` - изменение состава корзины

### Оформление заказа
- `checkout:payment` - выбор способа оплаты
- `checkout:address` - заполнение адреса
- `checkout:proceed` - переход к шагу с телефоном и эмейлом
- `checkout:phone` - заполнение телефона
- `checkout:email` - заполнение эмейла
- `checkout:place` - создание заказа